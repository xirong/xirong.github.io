<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸŒŸ å¤ªé˜³ç³»è¯†å­—ä¹å›­ - è·Ÿç€æ˜Ÿçƒå­¦æ±‰å­—</title>
    <link rel="preconnect" href="https://fonts.loli.net">
    <link rel="preconnect" href="https://fonts.loli.net" crossorigin>
    <link href="https://fonts.loli.net/css2?family=Noto+Sans+SC:wght@400;500;700;900&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --bg-dark: #0a0a1a;
            --primary-yellow: #ffd93d;
            --primary-pink: #ff6b9d;
            --primary-blue: #4ecdc4;
            --primary-purple: #a855f7;
            --primary-orange: #ff9f43;
            --primary-silver: #c0c0c0;
            --text-white: #ffffff;
            --text-light: rgba(255, 255, 255, 0.8);
        }

        body {
            font-family: 'Noto Sans SC', sans-serif;
            background: var(--bg-dark);
            color: var(--text-white);
            min-height: 100vh;
            overflow-x: hidden;
            user-select: none;
        }

        /* æ˜Ÿç©ºèƒŒæ™¯ */
        .stars {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 0;
        }

        .star {
            position: absolute;
            border-radius: 50%;
            background: #fff;
            animation: twinkle 3s infinite alternate;
        }

        @keyframes twinkle {
            0% { opacity: 0.3; }
            100% { opacity: 1; }
        }

        /* é¡¶éƒ¨å¯¼èˆª */
        .top-nav {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 100;
            padding: 15px 25px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: linear-gradient(180deg, rgba(10, 10, 26, 0.95) 0%, transparent 100%);
        }

        .back-btn {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 10px 20px;
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid rgba(255, 255, 255, 0.2);
            border-radius: 30px;
            color: var(--text-white);
            font-size: 1rem;
            text-decoration: none;
            transition: all 0.3s ease;
        }

        .back-btn:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: scale(1.05);
        }

        .title-area {
            text-align: center;
        }

        .title-area h1 {
            font-size: 1.8rem;
            font-weight: 900;
            background: linear-gradient(90deg, var(--primary-yellow), var(--primary-pink), var(--primary-blue));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            animation: title-glow 2s ease-in-out infinite alternate;
        }

        @keyframes title-glow {
            0% { filter: drop-shadow(0 0 10px rgba(255, 217, 61, 0.5)); }
            100% { filter: drop-shadow(0 0 20px rgba(78, 205, 196, 0.8)); }
        }

        .progress-badge {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 10px 20px;
            background: rgba(168, 85, 247, 0.2);
            border: 2px solid var(--primary-purple);
            border-radius: 20px;
            font-size: 1.2rem;
            font-weight: 700;
        }

        .progress-count {
            color: var(--primary-yellow);
        }

        /* è§†å›¾å®¹å™¨ */
        .view {
            display: none;
            position: relative;
            z-index: 1;
            min-height: 100vh;
            padding: 100px 20px 40px;
            flex-direction: column;
            align-items: center;
        }

        .view.active {
            display: flex;
        }

        /* ä¸»èœå• */
        #mainMenu {
            justify-content: center;
            gap: 40px;
        }

        .menu-title {
            font-size: 2rem;
            font-weight: 900;
            text-align: center;
            color: var(--primary-yellow);
        }

        .menu-buttons {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            max-width: 700px;
        }

        .menu-btn {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 10px;
            padding: 30px 40px;
            border: 3px solid rgba(255, 255, 255, 0.2);
            border-radius: 25px;
            background: rgba(255, 255, 255, 0.05);
            font-family: 'Noto Sans SC', sans-serif;
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--text-white);
            cursor: pointer;
            transition: all 0.3s ease;
            min-width: 280px;
        }

        .menu-btn:hover {
            transform: scale(1.08);
            background: rgba(255, 255, 255, 0.1);
        }

        .menu-btn[data-mode="flashcard"] {
            border-color: var(--primary-yellow);
            box-shadow: 0 8px 30px rgba(255, 217, 61, 0.3);
        }

        .menu-btn[data-mode="listen"] {
            border-color: var(--primary-blue);
            box-shadow: 0 8px 30px rgba(78, 205, 196, 0.3);
        }

        .menu-btn[data-mode="match"] {
            border-color: var(--primary-pink);
            box-shadow: 0 8px 30px rgba(255, 107, 157, 0.3);
        }

        .menu-btn[data-mode="explore"] {
            border-color: var(--primary-purple);
            box-shadow: 0 8px 30px rgba(168, 85, 247, 0.3);
        }

        .menu-btn .icon {
            font-size: 3rem;
        }

        /* æ˜Ÿçƒç»„è¿›åº¦ */
        .group-progress {
            display: flex;
            gap: 20px;
            margin-top: 30px;
            flex-wrap: wrap;
            justify-content: center;
        }

        .group-progress-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 8px;
        }

        .group-emoji {
            font-size: 2.5rem;
            filter: drop-shadow(0 4px 8px rgba(0, 0, 0, 0.5));
        }

        .progress-ring {
            width: 50px;
            height: 50px;
            position: relative;
        }

        .progress-ring svg {
            transform: rotate(-90deg);
        }

        .progress-ring .bg {
            stroke: rgba(255, 255, 255, 0.1);
        }

        .progress-ring .progress {
            stroke: var(--primary-yellow);
            stroke-linecap: round;
            transition: stroke-dashoffset 0.5s ease;
        }

        .progress-ring .count {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 0.8rem;
            font-weight: 700;
        }

        /* è¿”å›æŒ‰é’®ï¼ˆè§†å›¾å†…ï¼‰ */
        .view-back-btn {
            position: absolute;
            top: 100px;
            left: 25px;
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 10px 20px;
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid rgba(255, 255, 255, 0.2);
            border-radius: 30px;
            color: var(--text-white);
            font-family: 'Noto Sans SC', sans-serif;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .view-back-btn:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: scale(1.05);
        }

        /* ==================== è®¤å­—å¡ç‰‡æ¨¡å¼ ==================== */
        #flashcardView {
            padding-top: 120px;
        }

        .group-selector {
            display: flex;
            gap: 15px;
            margin-bottom: 30px;
            flex-wrap: wrap;
            justify-content: center;
        }

        .group-btn {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 5px;
            padding: 15px 25px;
            background: rgba(255, 255, 255, 0.05);
            border: 3px solid rgba(255, 255, 255, 0.2);
            border-radius: 20px;
            font-family: 'Noto Sans SC', sans-serif;
            font-size: 1rem;
            font-weight: 600;
            color: var(--text-white);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .group-btn:hover {
            transform: scale(1.1);
        }

        .group-btn.active {
            border-color: var(--primary-yellow);
            background: rgba(255, 217, 61, 0.2);
        }

        .group-btn .emoji {
            font-size: 2rem;
        }

        /* ç¿»è½¬å¡ç‰‡ */
        .flashcard-container {
            perspective: 1000px;
            margin: 20px 0;
        }

        .flashcard {
            width: 350px;
            height: 450px;
            position: relative;
            transform-style: preserve-3d;
            transition: transform 0.6s ease;
            cursor: pointer;
        }

        .flashcard.flipped {
            transform: rotateY(180deg);
        }

        .card-front,
        .card-back {
            position: absolute;
            width: 100%;
            height: 100%;
            backface-visibility: hidden;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            border-radius: 30px;
            padding: 30px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
        }

        .card-front {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.1) 0%, rgba(255, 255, 255, 0.05) 100%);
            border: 4px solid var(--primary-yellow);
        }

        .card-back {
            background: linear-gradient(135deg, rgba(255, 217, 61, 0.2) 0%, rgba(255, 159, 67, 0.1) 100%);
            border: 4px solid var(--primary-orange);
            transform: rotateY(180deg);
        }

        .card-char {
            font-size: 10rem;
            font-weight: 900;
            line-height: 1;
            background: linear-gradient(135deg, var(--primary-yellow), var(--primary-orange));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            text-shadow: none;
            filter: drop-shadow(0 4px 8px rgba(0, 0, 0, 0.3));
        }

        .card-pinyin {
            font-size: 2.5rem;
            font-weight: 600;
            color: var(--text-light);
            margin-top: 10px;
        }

        .card-emoji {
            font-size: 4rem;
            margin-top: 15px;
        }

        .card-context {
            font-size: 1.8rem;
            font-weight: 600;
            color: var(--text-white);
            margin-top: 20px;
            text-align: center;
            line-height: 1.5;
        }

        .card-back .card-char {
            font-size: 6rem;
        }

        .card-back .card-pinyin {
            font-size: 1.8rem;
        }

        /* å¡ç‰‡æ§åˆ¶ */
        .card-controls {
            display: flex;
            gap: 30px;
            margin-top: 30px;
            align-items: center;
        }

        .nav-arrow {
            width: 60px;
            height: 60px;
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            color: var(--text-white);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .nav-arrow:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: scale(1.1);
        }

        .speak-btn {
            width: 80px;
            height: 80px;
            background: linear-gradient(135deg, var(--primary-purple), #9333ea);
            border: none;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2.5rem;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 8px 30px rgba(168, 85, 247, 0.5);
        }

        .speak-btn:hover {
            transform: scale(1.1);
        }

        .speak-btn.speaking {
            animation: speak-pulse 0.5s ease-in-out infinite alternate;
        }

        @keyframes speak-pulse {
            0% { transform: scale(1); }
            100% { transform: scale(1.15); }
        }

        .card-progress {
            font-size: 1.2rem;
            color: var(--text-light);
            margin-top: 20px;
        }

        /* ==================== å¬éŸ³é€‰å­—æ¨¡å¼ ==================== */
        #listenView {
            justify-content: center;
            gap: 40px;
        }

        .listen-prompt {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 20px;
        }

        .big-speak-btn {
            padding: 25px 50px;
            background: linear-gradient(135deg, var(--primary-purple), #9333ea);
            border: none;
            border-radius: 30px;
            font-family: 'Noto Sans SC', sans-serif;
            font-size: 1.8rem;
            font-weight: 700;
            color: var(--text-white);
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 8px 40px rgba(168, 85, 247, 0.5);
        }

        .big-speak-btn:hover {
            transform: scale(1.05);
        }

        .big-speak-btn.speaking {
            animation: speak-pulse 0.5s ease-in-out infinite alternate;
        }

        .listen-hint {
            font-size: 1.3rem;
            color: var(--primary-yellow);
        }

        .options-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            max-width: 500px;
        }

        .option-btn {
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 30px 40px;
            background: rgba(255, 255, 255, 0.08);
            border: 3px solid rgba(255, 255, 255, 0.2);
            border-radius: 20px;
            font-family: 'Noto Sans SC', sans-serif;
            font-size: 4rem;
            font-weight: 900;
            color: var(--text-white);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .option-btn:hover {
            transform: scale(1.05);
            border-color: var(--primary-yellow);
            background: rgba(255, 217, 61, 0.2);
        }

        .option-btn.correct {
            background: rgba(78, 205, 196, 0.5);
            border-color: var(--primary-blue);
            animation: correct-pulse 0.5s ease;
        }

        .option-btn.wrong {
            background: rgba(255, 107, 157, 0.3);
            border-color: var(--primary-pink);
            animation: wrong-shake 0.5s ease;
        }

        @keyframes correct-pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.15); }
        }

        @keyframes wrong-shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-15px); }
            75% { transform: translateX(15px); }
        }

        .score-bar {
            font-size: 1.3rem;
            color: var(--text-light);
            display: flex;
            gap: 30px;
        }

        .score-bar .stars {
            color: var(--primary-yellow);
        }

        /* ==================== é…å¯¹æ¶ˆé™¤æ¨¡å¼ ==================== */
        #matchView {
            justify-content: center;
            gap: 30px;
        }

        .difficulty-select {
            display: flex;
            gap: 20px;
        }

        .difficulty-select button {
            padding: 20px 40px;
            background: rgba(255, 255, 255, 0.08);
            border: 3px solid rgba(255, 255, 255, 0.2);
            border-radius: 20px;
            font-family: 'Noto Sans SC', sans-serif;
            font-size: 1.3rem;
            font-weight: 700;
            color: var(--text-white);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .difficulty-select button:hover {
            transform: scale(1.05);
            border-color: var(--primary-yellow);
        }

        .match-grid {
            display: grid;
            gap: 15px;
            justify-content: center;
        }

        .match-card {
            width: 100px;
            height: 120px;
            perspective: 1000px;
            cursor: pointer;
        }

        .match-card-inner {
            position: relative;
            width: 100%;
            height: 100%;
            transform-style: preserve-3d;
            transition: transform 0.4s ease;
        }

        .match-card.flipped .match-card-inner {
            transform: rotateY(180deg);
        }

        .match-card.matched {
            visibility: hidden;
            pointer-events: none;
        }

        .match-card-front,
        .match-card-back {
            position: absolute;
            width: 100%;
            height: 100%;
            backface-visibility: hidden;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            border-radius: 15px;
            border: 3px solid;
        }

        .match-card-front {
            background: linear-gradient(135deg, rgba(168, 85, 247, 0.3), rgba(168, 85, 247, 0.1));
            border-color: var(--primary-purple);
            font-size: 2.5rem;
        }

        .match-card-back {
            background: rgba(255, 255, 255, 0.1);
            border-color: var(--primary-yellow);
            transform: rotateY(180deg);
        }

        .match-card-back .char {
            font-size: 3rem;
            font-weight: 900;
        }

        .match-card-back .emoji {
            font-size: 2rem;
        }

        .match-card-back .pinyin {
            font-size: 0.9rem;
            color: var(--text-light);
        }

        .match-stats {
            font-size: 1.2rem;
            color: var(--text-light);
            display: flex;
            gap: 30px;
        }

        .match-complete {
            display: none;
            flex-direction: column;
            align-items: center;
            gap: 20px;
        }

        .match-complete.visible {
            display: flex;
        }

        .match-complete .result-emoji {
            font-size: 5rem;
        }

        .match-complete .result-text {
            font-size: 2rem;
            font-weight: 900;
            color: var(--primary-yellow);
        }

        .match-complete .result-stats {
            font-size: 1.2rem;
            color: var(--text-light);
        }

        .play-again-btn {
            padding: 15px 40px;
            background: linear-gradient(135deg, var(--primary-blue), #45b7d1);
            border: none;
            border-radius: 25px;
            font-family: 'Noto Sans SC', sans-serif;
            font-size: 1.3rem;
            font-weight: 700;
            color: var(--text-white);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .play-again-btn:hover {
            transform: scale(1.05);
        }

        /* ==================== æ˜Ÿçƒå›¾é‰´æ¨¡å¼ ==================== */
        #exploreView {
            padding-top: 120px;
        }

        .planet-tabs {
            display: flex;
            gap: 15px;
            margin-bottom: 30px;
            flex-wrap: wrap;
            justify-content: center;
        }

        .planet-tab {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 5px;
            padding: 15px 25px;
            background: rgba(255, 255, 255, 0.05);
            border: 3px solid rgba(255, 255, 255, 0.2);
            border-radius: 20px;
            font-family: 'Noto Sans SC', sans-serif;
            font-size: 1rem;
            font-weight: 600;
            color: var(--text-white);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .planet-tab:hover {
            transform: scale(1.1);
        }

        .planet-tab.active {
            border-color: var(--primary-yellow);
            background: rgba(255, 217, 61, 0.2);
        }

        .planet-tab .emoji {
            font-size: 2.5rem;
        }

        .word-collection {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 20px;
            max-width: 900px;
            width: 100%;
        }

        .word-card {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
            background: rgba(255, 255, 255, 0.05);
            border: 3px solid rgba(255, 255, 255, 0.15);
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .word-card:hover {
            transform: scale(1.05);
            border-color: var(--primary-yellow);
        }

        .word-card.learned {
            border-color: var(--primary-yellow);
            background: rgba(255, 217, 61, 0.1);
            box-shadow: 0 0 20px rgba(255, 217, 61, 0.3);
        }

        .word-card .char {
            font-size: 4rem;
            font-weight: 900;
            background: linear-gradient(135deg, var(--primary-yellow), var(--primary-orange));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .word-card .pinyin {
            font-size: 1.2rem;
            color: var(--text-light);
            margin-top: 5px;
        }

        .word-card .emoji {
            font-size: 1.5rem;
            margin-top: 5px;
        }

        /* ==================== å¥–åŠ±å¼¹çª— ==================== */
        .reward-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 500;
            background: rgba(0, 0, 0, 0.85);
            display: none;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        .reward-overlay.visible {
            display: flex;
        }

        .reward-content {
            text-align: center;
            animation: reward-pop 0.5s cubic-bezier(0.68, -0.55, 0.265, 1.55);
        }

        @keyframes reward-pop {
            0% { transform: scale(0); opacity: 0; }
            100% { transform: scale(1); opacity: 1; }
        }

        .reward-emoji {
            font-size: 8rem;
            margin-bottom: 20px;
            animation: badge-shine 1s ease-in-out infinite;
        }

        @keyframes badge-shine {
            0%, 100% { filter: drop-shadow(0 0 20px rgba(255, 217, 61, 0.8)); }
            50% { filter: drop-shadow(0 0 40px rgba(255, 217, 61, 1)); }
        }

        .reward-text {
            font-size: 2.5rem;
            font-weight: 900;
            color: var(--primary-yellow);
            margin-bottom: 30px;
        }

        .reward-btn {
            padding: 15px 50px;
            background: linear-gradient(135deg, var(--primary-blue), #45b7d1);
            border: none;
            border-radius: 30px;
            font-family: 'Noto Sans SC', sans-serif;
            font-size: 1.3rem;
            font-weight: 700;
            color: white;
            cursor: pointer;
            transition: transform 0.3s ease;
        }

        .reward-btn:hover {
            transform: scale(1.1);
        }

        /* æ˜Ÿæ˜Ÿç²’å­ */
        .star-particle {
            position: fixed;
            font-size: 1.5rem;
            pointer-events: none;
            z-index: 600;
            animation: star-burst 1s ease-out forwards;
        }

        @keyframes star-burst {
            0% {
                opacity: 1;
                transform: scale(1) translate(0, 0);
            }
            100% {
                opacity: 0;
                transform: scale(0) translate(var(--tx), var(--ty));
            }
        }

        /* å“åº”å¼ */
        @media (max-width: 768px) {
            .top-nav {
                padding: 10px 15px;
                flex-wrap: wrap;
                gap: 10px;
            }

            .title-area h1 {
                font-size: 1.3rem;
            }

            .back-btn {
                padding: 8px 15px;
                font-size: 0.9rem;
            }

            .progress-badge {
                padding: 8px 15px;
                font-size: 1rem;
            }

            .menu-buttons {
                grid-template-columns: 1fr;
            }

            .menu-btn {
                min-width: auto;
                padding: 20px 30px;
                font-size: 1.2rem;
            }

            .flashcard {
                width: 300px;
                height: 400px;
            }

            .card-char {
                font-size: 8rem;
            }

            .card-back .card-char {
                font-size: 5rem;
            }

            .group-selector,
            .planet-tabs {
                gap: 10px;
            }

            .group-btn,
            .planet-tab {
                padding: 10px 15px;
                font-size: 0.9rem;
            }

            .group-btn .emoji,
            .planet-tab .emoji {
                font-size: 1.5rem;
            }

            .options-grid {
                gap: 15px;
            }

            .option-btn {
                padding: 20px;
                font-size: 3rem;
            }

            .word-collection {
                grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
                gap: 15px;
            }

            .word-card .char {
                font-size: 3rem;
            }

            .match-card {
                width: 80px;
                height: 100px;
            }

            .match-card-back .char {
                font-size: 2.5rem;
            }
        }

        @media (max-width: 480px) {
            .flashcard {
                width: 280px;
                height: 360px;
            }

            .card-char {
                font-size: 6rem;
            }

            .card-back .card-char {
                font-size: 4rem;
            }

            .card-pinyin {
                font-size: 2rem;
            }

            .card-context {
                font-size: 1.4rem;
            }
        }
    </style>
</head>

<body>
    <!-- æ˜Ÿç©ºèƒŒæ™¯ -->
    <div class="stars" id="stars"></div>

    <!-- é¡¶éƒ¨å¯¼èˆª -->
    <nav class="top-nav">
        <a href="../index.html" class="back-btn">
            <span>ğŸ </span>
            <span>è¿”å›é¦–é¡µ</span>
        </a>
        <div class="title-area">
            <h1>ğŸŒŸ å¤ªé˜³ç³»è¯†å­—ä¹å›­</h1>
        </div>
        <div class="progress-badge">
            <span class="progress-count" id="progressCount">0</span>/154 å­—
        </div>
    </nav>

    <!-- ä¸»èœå• -->
    <div class="view active" id="mainMenu">
        <div class="menu-title">é€‰æ‹©å­¦ä¹ æ–¹å¼</div>
        <div class="menu-buttons">
            <button class="menu-btn" data-mode="flashcard">
                <span class="icon">ğŸƒ</span>
                <span>è®¤å­—å¡ç‰‡</span>
            </button>
            <button class="menu-btn" data-mode="listen">
                <span class="icon">ğŸ‘‚</span>
                <span>å¬éŸ³é€‰å­—</span>
            </button>
            <button class="menu-btn" data-mode="match">
                <span class="icon">ğŸ§©</span>
                <span>é…å¯¹æ¶ˆé™¤</span>
            </button>
            <button class="menu-btn" data-mode="explore">
                <span class="icon">ğŸª</span>
                <span>æ˜Ÿçƒå›¾é‰´</span>
            </button>
        </div>
        <div class="group-progress" id="groupProgress"></div>
    </div>

    <!-- è®¤å­—å¡ç‰‡è§†å›¾ -->
    <div class="view" id="flashcardView">
        <button class="view-back-btn" id="flashcardBack">â—€ è¿”å›</button>
        <div class="group-selector" id="groupSelector"></div>
        <div class="flashcard-container">
            <div class="flashcard" id="flashcard">
                <div class="card-front">
                    <div class="card-char" id="cardChar">å¤ª</div>
                    <div class="card-pinyin" id="cardPinyin">tÃ i</div>
                    <div class="card-emoji" id="cardEmoji">â˜€ï¸</div>
                </div>
                <div class="card-back">
                    <div class="card-char" id="cardCharBack">å¤ª</div>
                    <div class="card-pinyin" id="cardPinyinBack">tÃ i</div>
                    <div class="card-emoji" id="cardEmojiBack">â˜€ï¸</div>
                    <div class="card-context" id="cardContext">å¤ªé˜³å¾ˆå¤§å¾ˆçƒ­</div>
                </div>
            </div>
        </div>
        <div class="card-controls">
            <button class="nav-arrow" id="prevCard">â—€</button>
            <button class="speak-btn" id="speakBtn">ğŸ”Š</button>
            <button class="nav-arrow" id="nextCard">â–¶</button>
        </div>
        <div class="card-progress" id="cardProgress">ç¬¬ 1 / 8 å­—</div>
    </div>

    <!-- å¬éŸ³é€‰å­—è§†å›¾ -->
    <div class="view" id="listenView">
        <button class="view-back-btn" id="listenBack">â—€ è¿”å›</button>
        <div class="listen-prompt">
            <button class="big-speak-btn" id="listenSpeak">ğŸ”Š å†å¬ä¸€æ¬¡</button>
            <div class="listen-hint" id="listenHint">ç‚¹å‡»ä¸Šæ–¹æŒ‰é’®å¬å‘éŸ³ï¼Œé€‰å‡ºæ­£ç¡®çš„å­—</div>
        </div>
        <div class="options-grid" id="optionsGrid"></div>
        <div class="score-bar">
            <span id="questionNum">ç¬¬ 1 / 10 é¢˜</span>
            <span class="stars">â­ <span id="listenScore">0</span> åˆ†</span>
        </div>
    </div>

    <!-- é…å¯¹æ¶ˆé™¤è§†å›¾ -->
    <div class="view" id="matchView">
        <button class="view-back-btn" id="matchBack">â—€ è¿”å›</button>
        <div class="difficulty-select" id="difficultySelect">
            <button data-pairs="3">â­ ç®€å•</button>
            <button data-pairs="6">â­â­ æ™®é€š</button>
            <button data-pairs="9">â­â­â­ å›°éš¾</button>
        </div>
        <div class="match-grid" id="matchGrid"></div>
        <div class="match-stats" id="matchStats">
            <span>ç¿»ç‰Œ: <span id="flipCount">0</span> æ¬¡</span>
            <span>å·²é…å¯¹: <span id="matchedCount">0</span>/<span id="totalPairs">0</span></span>
        </div>
        <div class="match-complete" id="matchComplete">
            <div class="result-emoji">ğŸ‰</div>
            <div class="result-text">å¤ªæ£’äº†ï¼å…¨éƒ¨é…å¯¹æˆåŠŸï¼</div>
            <div class="result-stats" id="matchResultStats"></div>
            <button class="play-again-btn" id="playAgainBtn">å†ç©ä¸€æ¬¡</button>
        </div>
    </div>

    <!-- æ˜Ÿçƒå›¾é‰´è§†å›¾ -->
    <div class="view" id="exploreView">
        <button class="view-back-btn" id="exploreBack">â—€ è¿”å›</button>
        <div class="planet-tabs" id="planetTabs"></div>
        <div class="word-collection" id="wordCollection"></div>
    </div>

    <!-- å¥–åŠ±å¼¹çª— -->
    <div class="reward-overlay" id="rewardOverlay">
        <div class="reward-content">
            <div class="reward-emoji" id="rewardEmoji">ğŸ‰</div>
            <div class="reward-text" id="rewardText">å¤ªæ£’äº†ï¼</div>
            <button class="reward-btn" id="rewardBtn">ç»§ç»­</button>
        </div>
    </div>

    <script>
        // ==================== æ±‰å­—æ•°æ® ====================
        const wordGroups = [
            // ========== åŸæœ‰å¤ªé˜³ç³»ä¸»é¢˜ï¼ˆ50å­—ï¼‰==========
            {
                id: 'sun', name: 'å¤ªé˜³', emoji: 'â˜€ï¸', color: '#ffd93d',
                words: [
                    { char: 'å¤ª', pinyin: 'tÃ i', emoji: 'â˜€ï¸', context: 'å¤ªé˜³å¾ˆå¤§å¾ˆçƒ­' },
                    { char: 'é˜³', pinyin: 'yÃ¡ng', emoji: 'ğŸŒ…', context: 'é˜³å…‰ç…§å¤§åœ°' },
                    { char: 'æ—¥', pinyin: 'rÃ¬', emoji: 'ğŸŒ', context: 'æ—¥å‡ºä¸œæ–¹çº¢' },
                    { char: 'å…‰', pinyin: 'guÄng', emoji: 'âœ¨', context: 'é˜³å…‰æš–æ´‹æ´‹' },
                    { char: 'çƒ­', pinyin: 'rÃ¨', emoji: 'ğŸ”¥', context: 'å¤å¤©å¾ˆçƒ­' },
                    { char: 'å¤§', pinyin: 'dÃ ', emoji: 'ğŸŒŸ', context: 'å¤ªé˜³å¾ˆå¤§' },
                    { char: 'ç«', pinyin: 'huÇ’', emoji: 'ğŸ”¥', context: 'ç«çº¢çš„å¤ªé˜³' },
                    { char: 'çº¢', pinyin: 'hÃ³ng', emoji: 'ğŸ”´', context: 'çº¢çº¢çš„å¤ªé˜³' }
                ]
            },
            {
                id: 'earth', name: 'åœ°çƒ', emoji: 'ğŸŒ', color: '#4ecdc4',
                words: [
                    { char: 'åœ°', pinyin: 'dÃ¬', emoji: 'ğŸŒ', context: 'åœ°çƒæ˜¯æˆ‘ä»¬çš„å®¶' },
                    { char: 'çƒ', pinyin: 'qiÃº', emoji: 'âš½', context: 'åœ°çƒæ˜¯åœ†çš„' },
                    { char: 'æ°´', pinyin: 'shuÇ', emoji: 'ğŸ’§', context: 'æ°´æ˜¯ç”Ÿå‘½ä¹‹æº' },
                    { char: 'å±±', pinyin: 'shÄn', emoji: 'â›°ï¸', context: 'é«˜é«˜çš„å¤§å±±' },
                    { char: 'é£', pinyin: 'fÄ“ng', emoji: 'ğŸ’¨', context: 'é£å¹ç™½äº‘é£˜' },
                    { char: 'äº‘', pinyin: 'yÃºn', emoji: 'â˜ï¸', context: 'ç™½äº‘åœ¨å¤©ä¸Š' },
                    { char: 'æ°”', pinyin: 'qÃ¬', emoji: 'ğŸŒ¬ï¸', context: 'ç©ºæ°”å¾ˆæ¸…æ–°' },
                    { char: 'è“', pinyin: 'lÃ¡n', emoji: 'ğŸ”µ', context: 'è“è“çš„å¤©ç©º' }
                ]
            },
            {
                id: 'moon', name: 'æœˆäº®', emoji: 'ğŸŒ™', color: '#c0c0c0',
                words: [
                    { char: 'æœˆ', pinyin: 'yuÃ¨', emoji: 'ğŸŒ™', context: 'æœˆäº®å¼¯å¼¯' },
                    { char: 'å¤œ', pinyin: 'yÃ¨', emoji: 'ğŸŒƒ', context: 'å¤œæ™šçœ‹æ˜Ÿæ˜Ÿ' },
                    { char: 'åœ†', pinyin: 'yuÃ¡n', emoji: 'ğŸ”µ', context: 'æœˆäº®åœ†åœ†çš„' },
                    { char: 'ç™½', pinyin: 'bÃ¡i', emoji: 'âšª', context: 'ç™½ç™½çš„æœˆå…‰' },
                    { char: 'å°', pinyin: 'xiÇo', emoji: 'ğŸ”¹', context: 'å°å°çš„æ˜Ÿæ˜Ÿ' },
                    { char: 'å†·', pinyin: 'lÄ›ng', emoji: 'â„ï¸', context: 'æœˆçƒå¾ˆå†·' },
                    { char: 'çŸ³', pinyin: 'shÃ­', emoji: 'ğŸª¨', context: 'æœˆçƒæœ‰çŸ³å¤´' },
                    { char: 'å†°', pinyin: 'bÄ«ng', emoji: 'ğŸ§Š', context: 'å†°å†·çš„æœˆå¤œ' }
                ]
            },
            {
                id: 'stars', name: 'æ˜Ÿæ˜Ÿ', emoji: 'â­', color: '#a855f7',
                words: [
                    { char: 'æ˜Ÿ', pinyin: 'xÄ«ng', emoji: 'â­', context: 'æ˜Ÿæ˜Ÿäº®æ™¶æ™¶' },
                    { char: 'é‡‘', pinyin: 'jÄ«n', emoji: 'ğŸŒŸ', context: 'é‡‘æ˜Ÿå¾ˆäº®' },
                    { char: 'æœ¨', pinyin: 'mÃ¹', emoji: 'ğŸªµ', context: 'æœ¨æ˜Ÿæœ€å¤§' },
                    { char: 'åœŸ', pinyin: 'tÇ”', emoji: 'ğŸŸ¤', context: 'åœŸæ˜Ÿæœ‰å…‰ç¯' },
                    { char: 'å¤©', pinyin: 'tiÄn', emoji: 'ğŸŒŒ', context: 'å¤©ä¸Šæœ‰æ˜Ÿæ˜Ÿ' },
                    { char: 'ç‹', pinyin: 'wÃ¡ng', emoji: 'ğŸ‘‘', context: 'å¤©ç‹æ˜Ÿåœ¨è¿œæ–¹' },
                    { char: 'æµ·', pinyin: 'hÇi', emoji: 'ğŸŒŠ', context: 'æµ·ç‹æ˜Ÿæ˜¯è“è‰²' },
                    { char: 'å†¥', pinyin: 'mÃ­ng', emoji: 'ğŸ”®', context: 'å†¥ç‹æ˜Ÿå¾ˆå°' }
                ]
            },
            {
                id: 'space', name: 'å¤ªç©º', emoji: 'ğŸš€', color: '#ff9f43',
                words: [
                    { char: 'é£', pinyin: 'fÄ“i', emoji: 'ğŸš€', context: 'ç«ç®­é£ä¸Šå¤©' },
                    { char: 'ä¸Š', pinyin: 'shÃ ng', emoji: 'â¬†ï¸', context: 'é£å‘ä¸Šæ–¹' },
                    { char: 'ä¸‹', pinyin: 'xiÃ ', emoji: 'â¬‡ï¸', context: 'é™è½åˆ°åœ°ä¸‹' },
                    { char: 'å·¦', pinyin: 'zuÇ’', emoji: 'â¬…ï¸', context: 'å‘å·¦è½¬' },
                    { char: 'å³', pinyin: 'yÃ²u', emoji: 'â¡ï¸', context: 'å‘å³è½¬' },
                    { char: 'è½¬', pinyin: 'zhuÇn', emoji: 'ğŸ”„', context: 'åœ°çƒåœ¨è½¬åŠ¨' },
                    { char: 'çœ‹', pinyin: 'kÃ n', emoji: 'ğŸ‘€', context: 'çœ‹çœ‹æ˜Ÿæ˜Ÿ' },
                    { char: 'æ‰¾', pinyin: 'zhÇo', emoji: 'ğŸ”', context: 'æ‰¾æ‰¾æœˆäº®' }
                ]
            },
            {
                id: 'numbers', name: 'æ•°å­—', emoji: 'ğŸ”¢', color: '#ff6b9d',
                words: [
                    { char: 'ä¸€', pinyin: 'yÄ«', emoji: '1ï¸âƒ£', context: 'ä¸€é¢—æ˜Ÿæ˜Ÿ' },
                    { char: 'äºŒ', pinyin: 'Ã¨r', emoji: '2ï¸âƒ£', context: 'äºŒä¸ªæœˆäº®' },
                    { char: 'ä¸‰', pinyin: 'sÄn', emoji: '3ï¸âƒ£', context: 'ä¸‰æœµç™½äº‘' },
                    { char: 'å››', pinyin: 'sÃ¬', emoji: '4ï¸âƒ£', context: 'å››å­£å˜åŒ–' },
                    { char: 'äº”', pinyin: 'wÇ”', emoji: '5ï¸âƒ£', context: 'äº”é¢—è¡Œæ˜Ÿ' },
                    { char: 'å…­', pinyin: 'liÃ¹', emoji: '6ï¸âƒ£', context: 'å…­ç§é¢œè‰²' },
                    { char: 'ä¸ƒ', pinyin: 'qÄ«', emoji: '7ï¸âƒ£', context: 'ä¸ƒè‰²å½©è™¹' },
                    { char: 'å…«', pinyin: 'bÄ', emoji: '8ï¸âƒ£', context: 'å…«å¤§è¡Œæ˜Ÿ' },
                    { char: 'ä¹', pinyin: 'jiÇ”', emoji: '9ï¸âƒ£', context: 'ä¹é¢—å«æ˜Ÿ' },
                    { char: 'å', pinyin: 'shÃ­', emoji: 'ğŸ”Ÿ', context: 'åä¸ªæ‰‹æŒ‡' }
                ]
            },
            // ========== å¹¼å„¿å›­è¯¾æœ¬åŒæ­¥ï¼ˆ104å­—ï¼‰==========
            {
                id: 'direction', name: 'æ–¹ä½æ¢ç´¢', emoji: 'ğŸ§­', color: '#00bcd4',
                words: [
                    { char: 'ä¸œ', pinyin: 'dÅng', emoji: 'ğŸŒ…', context: 'å¤ªé˜³ä»ä¸œè¾¹å‡èµ·' },
                    { char: 'è¥¿', pinyin: 'xÄ«', emoji: 'ğŸŒ‡', context: 'å¤ªé˜³ä»è¥¿è¾¹è½ä¸‹' },
                    { char: 'å—', pinyin: 'nÃ¡n', emoji: 'ğŸ§­', context: 'å—æ–¹å¾ˆæ¸©æš–' },
                    { char: 'åŒ—', pinyin: 'bÄ›i', emoji: 'â„ï¸', context: 'åŒ—æ–¹æœ‰é›ª' },
                    { char: 'ä¸­', pinyin: 'zhÅng', emoji: 'â­•', context: 'åœ¨ä¸­é—´' },
                    { char: 'å‰', pinyin: 'qiÃ¡n', emoji: 'â©', context: 'å‘å‰èµ°' },
                    { char: 'å', pinyin: 'hÃ²u', emoji: 'âª', context: 'åœ¨åé¢' },
                    { char: 'è¾¹', pinyin: 'biÄn', emoji: 'ğŸ“', context: 'åœ¨æ—è¾¹' },
                    { char: 'è¿œ', pinyin: 'yuÇn', emoji: 'ğŸ”­', context: 'å¾ˆè¿œå¾ˆè¿œ' },
                    { char: 'è¿‘', pinyin: 'jÃ¬n', emoji: 'ğŸ‘‹', context: 'ç¦»å¾—å¾ˆè¿‘' },
                    { char: 'å…¥', pinyin: 'rÃ¹', emoji: 'ğŸšª', context: 'è¿›å…¥æˆ¿é—´' }
                ]
            },
            {
                id: 'seasons', name: 'å››å­£æ—¶å…‰', emoji: 'ğŸŒ¸', color: '#e91e63',
                words: [
                    { char: 'æ˜¥', pinyin: 'chÅ«n', emoji: 'ğŸŒ¸', context: 'æ˜¥å¤©æ¥äº†' },
                    { char: 'å¤', pinyin: 'xiÃ ', emoji: 'â˜€ï¸', context: 'å¤å¤©å¾ˆçƒ­' },
                    { char: 'å†¬', pinyin: 'dÅng', emoji: 'â„ï¸', context: 'å†¬å¤©ä¸‹é›ª' },
                    { char: 'ç©º', pinyin: 'kÅng', emoji: 'ğŸŒŒ', context: 'å¤©ç©ºå¾ˆè“' },
                    { char: 'ä»Š', pinyin: 'jÄ«n', emoji: 'ğŸ“…', context: 'ä»Šå¤©çœŸå¥½' },
                    { char: 'æ—©', pinyin: 'zÇo', emoji: 'ğŸŒ…', context: 'æ—©ä¸Šå¥½' },
                    { char: 'å…¬', pinyin: 'gÅng', emoji: 'ğŸ›ï¸', context: 'å…¬å›­é‡Œç©' },
                    { char: 'æ­£', pinyin: 'zhÃ¨ng', emoji: 'âœ“', context: 'æ­£åœ¨å­¦ä¹ ' }
                ]
            },
            {
                id: 'colors', name: 'ç¼¤çº·è‰²å½©', emoji: 'ğŸ¨', color: '#9c27b0',
                words: [
                    { char: 'é’', pinyin: 'qÄ«ng', emoji: 'ğŸ’š', context: 'é’é’çš„è‰' },
                    { char: 'é»„', pinyin: 'huÃ¡ng', emoji: 'ğŸ’›', context: 'é»„é»„çš„èŠ±' },
                    { char: 'é»‘', pinyin: 'hÄ“i', emoji: 'âš«', context: 'é»‘é»‘çš„å¤œ' },
                    { char: 'å½©', pinyin: 'cÇi', emoji: 'ğŸŒˆ', context: 'å½©è™¹çœŸç¾' },
                    { char: 'è‰²', pinyin: 'sÃ¨', emoji: 'ğŸ¨', context: 'äº”é¢œå…­è‰²' },
                    { char: 'ç¾', pinyin: 'mÄ›i', emoji: 'ğŸ’–', context: 'ç¾ä¸½çš„èŠ±' },
                    { char: 'ä¸½', pinyin: 'lÃ¬', emoji: 'ğŸ‘¸', context: 'ç¾ä¸½å…¬ä¸»' },
                    { char: 'ç‚¹', pinyin: 'diÇn', emoji: 'âœ¨', context: 'å°ç‚¹ç‚¹' }
                ]
            },
            {
                id: 'animals', name: 'å¯çˆ±åŠ¨ç‰©', emoji: 'ğŸ±', color: '#ff5722',
                words: [
                    { char: 'é±¼', pinyin: 'yÃº', emoji: 'ğŸŸ', context: 'å°é±¼æ¸¸æ¸¸' },
                    { char: 'çŒ«', pinyin: 'mÄo', emoji: 'ğŸ±', context: 'å°çŒ«å–µå–µ' },
                    { char: 'ç‹—', pinyin: 'gÇ’u', emoji: 'ğŸ•', context: 'å°ç‹—æ±ªæ±ª' },
                    { char: 'é¹…', pinyin: 'Ã©', emoji: 'ğŸ¦¢', context: 'å¤§ç™½é¹…' },
                    { char: 'å°¾', pinyin: 'wÄ›i', emoji: 'ğŸ¦Š', context: 'é•¿å°¾å·´' },
                    { char: 'å·´', pinyin: 'ba', emoji: 'ğŸ’', context: 'å°¾å·´æ‘‡æ‘‡' },
                    { char: 'å®ƒ', pinyin: 'tÄ', emoji: 'ğŸ¾', context: 'å®ƒæ˜¯å°çŒ«' },
                    { char: 'ç¾¤', pinyin: 'qÃºn', emoji: 'ğŸ‘', context: 'ä¸€ç¾¤å°ç¾Š' }
                ]
            },
            {
                id: 'nature', name: 'è‡ªç„¶ä¸‡ç‰©', emoji: 'ğŸŒ²', color: '#4caf50',
                words: [
                    { char: 'æ£®', pinyin: 'sÄ“n', emoji: 'ğŸŒ²', context: 'æ£®æ—é‡Œ' },
                    { char: 'æ—', pinyin: 'lÃ­n', emoji: 'ğŸŒ³', context: 'æ ‘æ—é‡Œ' },
                    { char: 'æ±Ÿ', pinyin: 'jiÄng', emoji: 'ğŸŒŠ', context: 'å¤§æ±Ÿå¤§æ²³' },
                    { char: 'é—ª', pinyin: 'shÇn', emoji: 'âš¡', context: 'é—ªé—ªå‘å…‰' },
                    { char: 'è‹¹', pinyin: 'pÃ­ng', emoji: 'ğŸ', context: 'è‹¹æœçº¢' },
                    { char: 'æœ', pinyin: 'guÇ’', emoji: 'ğŸ‡', context: 'æ°´æœç”œ' },
                    { char: 'æ', pinyin: 'xÃ¬ng', emoji: 'ğŸ‘', context: 'æå­é»„' },
                    { char: 'æ¢¨', pinyin: 'lÃ­', emoji: 'ğŸ', context: 'æ¢¨å­ç”œ' }
                ]
            },
            {
                id: 'family', name: 'å®¶äººæœ‹å‹', emoji: 'ğŸ‘¨â€ğŸ‘©â€ğŸ‘§', color: '#2196f3',
                words: [
                    { char: 'æœ‹', pinyin: 'pÃ©ng', emoji: 'ğŸ‘«', context: 'å¥½æœ‹å‹' },
                    { char: 'å‹', pinyin: 'yÇ’u', emoji: 'ğŸ¤', context: 'æœ‹å‹å¤š' },
                    { char: 'å¼Ÿ', pinyin: 'dÃ¬', emoji: 'ğŸ‘¦', context: 'å°å¼Ÿå¼Ÿ' },
                    { char: 'å§', pinyin: 'jiÄ›', emoji: 'ğŸ‘§', context: 'å¤§å§å§' },
                    { char: 'å¨ƒ', pinyin: 'wÃ¡', emoji: 'ğŸ‘¶', context: 'å°å¨ƒå¨ƒ' },
                    { char: 'ä»¬', pinyin: 'men', emoji: 'ğŸ‘¨â€ğŸ‘©â€ğŸ‘§', context: 'æˆ‘ä»¬ä¸€èµ·' },
                    { char: 'è°', pinyin: 'shuÃ­', emoji: 'â“', context: 'æ˜¯è°å‘€' },
                    { char: 'å‡ ', pinyin: 'jÇ', emoji: 'ğŸ”¢', context: 'æœ‰å‡ ä¸ª' }
                ]
            },
            {
                id: 'feelings', name: 'å¿ƒæƒ…æ„Ÿå—', emoji: 'â¤ï¸', color: '#f44336',
                words: [
                    { char: 'å¥½', pinyin: 'hÇo', emoji: 'ğŸ‘', context: 'çœŸå¥½å‘€' },
                    { char: 'å¿ƒ', pinyin: 'xÄ«n', emoji: 'â¤ï¸', context: 'å¼€å¿ƒç¬‘' },
                    { char: 'å–œ', pinyin: 'xÇ', emoji: 'ğŸ˜Š', context: 'å–œæ¬¢ä½ ' },
                    { char: 'æ¬¢', pinyin: 'huÄn', emoji: 'ğŸ‰', context: 'æ¬¢ä¹å¤š' },
                    { char: 'æ€•', pinyin: 'pÃ ', emoji: 'ğŸ˜¨', context: 'ä¸è¦æ€•' },
                    { char: 'å®³', pinyin: 'hÃ i', emoji: 'ğŸ˜°', context: 'å®³æ€•äº†' },
                    { char: 'å£°', pinyin: 'shÄ“ng', emoji: 'ğŸ”Š', context: 'å¤§å£°è¯´' },
                    { char: 'æœ€', pinyin: 'zuÃ¬', emoji: 'ğŸ†', context: 'æœ€æ£’äº†' }
                ]
            },
            {
                id: 'items', name: 'ç”Ÿæ´»ç”¨å“', emoji: 'ğŸ’', color: '#795548',
                words: [
                    { char: 'ä¼', pinyin: 'sÇn', emoji: 'â˜‚ï¸', context: 'æ‰“ä¼å•¦' },
                    { char: 'ä¹¦', pinyin: 'shÅ«', emoji: 'ğŸ“š', context: 'çœ‹ä¹¦æœ¬' },
                    { char: 'è¡£', pinyin: 'yÄ«', emoji: 'ğŸ‘•', context: 'ç©¿è¡£æœ' },
                    { char: 'åˆ€', pinyin: 'dÄo', emoji: 'ğŸ”ª', context: 'å°å‰ªåˆ€' },
                    { char: 'åŒ…', pinyin: 'bÄo', emoji: 'ğŸ’', context: 'å°ä¹¦åŒ…' },
                    { char: 'è´', pinyin: 'bÃ¨i', emoji: 'ğŸš', context: 'è´å£³ç¾' },
                    { char: 'åŒ', pinyin: 'shuÄng', emoji: 'ğŸ‘Ÿ', context: 'ä¸€åŒé‹' },
                    { char: 'ä¸²', pinyin: 'chuÃ n', emoji: 'ğŸ“¿', context: 'ä¸€ä¸²ç ' },
                    { char: 'æ¡', pinyin: 'tiÃ¡o', emoji: 'ğŸ“', context: 'ä¸€æ¡çº¿' }
                ]
            },
            {
                id: 'shapes', name: 'å½¢çŠ¶å¤§å°', emoji: 'ğŸ“', color: '#607d8b',
                words: [
                    { char: 'é•¿', pinyin: 'chÃ¡ng', emoji: 'ğŸ“', context: 'é•¿é•¿çš„' },
                    { char: 'çŸ­', pinyin: 'duÇn', emoji: 'ğŸ“', context: 'çŸ­çŸ­çš„' },
                    { char: 'å¼¯', pinyin: 'wÄn', emoji: 'ğŸŒ™', context: 'å¼¯å¼¯çš„' },
                    { char: 'åŠ', pinyin: 'bÃ n', emoji: 'â—', context: 'ä¸€åŠ' },
                    { char: 'å…¨', pinyin: 'quÃ¡n', emoji: 'â­•', context: 'å…¨éƒ¨' },
                    { char: 'åŠ›', pinyin: 'lÃ¬', emoji: 'ğŸ’ª', context: 'æœ‰åŠ›æ°”' },
                    { char: 'ç«‹', pinyin: 'lÃ¬', emoji: 'ğŸ§', context: 'ç«™ç«‹å¥½' }
                ]
            },
            {
                id: 'actions1', name: 'æ—¥å¸¸åŠ¨ä½œ', emoji: 'ğŸƒ', color: '#009688',
                words: [
                    { char: 'å»', pinyin: 'qÃ¹', emoji: 'ğŸš¶', context: 'å»ç©è€' },
                    { char: 'è¯´', pinyin: 'shuÅ', emoji: 'ğŸ’¬', context: 'è¯´è¯å•¦' },
                    { char: 'è§', pinyin: 'jiÃ n', emoji: 'ğŸ‘€', context: 'çœ‹è§äº†' },
                    { char: 'å¼€', pinyin: 'kÄi', emoji: 'ğŸ”“', context: 'å¼€é—¨å•¦' },
                    { char: 'å…³', pinyin: 'guÄn', emoji: 'ğŸ”’', context: 'å…³é—¨å¥½' },
                    { char: 'è¯»', pinyin: 'dÃº', emoji: 'ğŸ“–', context: 'è¯»ä¹¦å£°' },
                    { char: 'ç©¿', pinyin: 'chuÄn', emoji: 'ğŸ‘”', context: 'ç©¿è¡£æœ' },
                    { char: 'æ¸¸', pinyin: 'yÃ³u', emoji: 'ğŸŠ', context: 'æ¸¸æ³³å»' }
                ]
            },
            {
                id: 'actions2', name: 'æ›´å¤šåŠ¨ä½œ', emoji: 'âœ¨', color: '#673ab7',
                words: [
                    { char: 'å˜', pinyin: 'biÃ n', emoji: 'ğŸ¦‹', context: 'å˜å˜å˜' },
                    { char: 'å‘', pinyin: 'fÄ', emoji: 'ğŸ“¤', context: 'å‘å‡ºå»' },
                    { char: 'å­¦', pinyin: 'xuÃ©', emoji: 'ğŸ“š', context: 'å­¦çŸ¥è¯†' },
                    { char: 'èµ·', pinyin: 'qÇ', emoji: 'ğŸŒ…', context: 'èµ·åºŠå•¦' },
                    { char: 'è¦', pinyin: 'yÃ o', emoji: 'ğŸ™‹', context: 'æˆ‘è¦è¦' },
                    { char: 'æŠŠ', pinyin: 'bÇ', emoji: 'ğŸ¤²', context: 'æŠŠå®ƒç»™æˆ‘' },
                    { char: 'è¿‡', pinyin: 'guÃ²', emoji: 'ğŸš¶', context: 'èµ°è¿‡å»' },
                    { char: 'åˆ°', pinyin: 'dÃ o', emoji: 'ğŸ“', context: 'åˆ°è¾¾äº†' }
                ]
            },
            {
                id: 'connectors', name: 'è¿æ¥å°å­—', emoji: 'ğŸ”—', color: '#3f51b5',
                words: [
                    { char: 'åœ¨', pinyin: 'zÃ i', emoji: 'ğŸ“', context: 'åœ¨è¿™é‡Œ' },
                    { char: 'å¯', pinyin: 'kÄ›', emoji: 'ğŸ‘Œ', context: 'å¯ä»¥çš„' },
                    { char: 'æœ‰', pinyin: 'yÇ’u', emoji: 'âœ”ï¸', context: 'æœ‰ä¸œè¥¿' },
                    { char: 'ä»¥', pinyin: 'yÇ', emoji: 'ğŸ‘', context: 'å¯ä»¥ç©' },
                    { char: 'ä»', pinyin: 'cÃ³ng', emoji: 'ğŸš¶', context: 'ä»è¿™èµ°' },
                    { char: 'ä¹ˆ', pinyin: 'me', emoji: 'â“', context: 'ä»€ä¹ˆå‘€' },
                    { char: 'å°±', pinyin: 'jiÃ¹', emoji: 'â¡ï¸', context: 'å°±æ˜¯å®ƒ' },
                    { char: 'å§', pinyin: 'ba', emoji: 'ğŸ˜Š', context: 'å¥½å§å¥½å§' }
                ]
            },
            {
                id: 'others', name: 'å…¶ä»–å¸¸ç”¨', emoji: 'ğŸ¯', color: '#ff9800',
                words: [
                    { char: 'äº¤', pinyin: 'jiÄo', emoji: 'ğŸ¤', context: 'äº¤æœ‹å‹' },
                    { char: 'æ¬ ', pinyin: 'qiÃ n', emoji: 'ğŸ¥±', context: 'æ‰“å“ˆæ¬ ' },
                    { char: 'åŠ', pinyin: 'bÃ n', emoji: 'ğŸ“‹', context: 'åŠäº‹æƒ…' },
                    { char: 'ä»€', pinyin: 'shÃ©n', emoji: 'â“', context: 'ä»€ä¹ˆ' },
                    { char: 'å‘€', pinyin: 'ya', emoji: 'ğŸ˜®', context: 'æ˜¯å‘€' }
                ]
            }
        ];

        // ==================== çŠ¶æ€ç®¡ç† ====================
        let currentView = 'mainMenu';
        let currentGroupIndex = 0;
        let currentCardIndex = 0;
        let learnedWords = [];

        // å¬éŸ³é€‰å­—çŠ¶æ€
        let listenQuestions = [];
        let currentQuestionIndex = 0;
        let listenScore = 0;
        let currentAnswer = null;

        // é…å¯¹æ¶ˆé™¤çŠ¶æ€
        let matchCards = [];
        let flippedCards = [];
        let matchedPairs = 0;
        let totalMatchPairs = 0;
        let flipCount = 0;
        let isChecking = false;

        // ==================== è¿›åº¦ç³»ç»Ÿ ====================
        function getProgress() {
            try {
                const saved = localStorage.getItem('spaceWordsProgress');
                if (saved) {
                    const data = JSON.parse(saved);
                    learnedWords = data.learned || [];
                    return data;
                }
            } catch (e) {
                console.error('è¯»å–è¿›åº¦å¤±è´¥', e);
            }
            return { learned: [], quizScores: {}, lastGroup: 'sun' };
        }

        function saveProgress() {
            try {
                const data = {
                    learned: learnedWords,
                    quizScores: {},
                    lastGroup: wordGroups[currentGroupIndex].id
                };
                localStorage.setItem('spaceWordsProgress', JSON.stringify(data));
            } catch (e) {
                console.error('ä¿å­˜è¿›åº¦å¤±è´¥', e);
            }
        }

        function markLearned(char) {
            if (!learnedWords.includes(char)) {
                learnedWords.push(char);
                saveProgress();
                updateProgressUI();
            }
        }

        function updateProgressUI() {
            document.getElementById('progressCount').textContent = learnedWords.length;
            renderGroupProgress();
        }

        function renderGroupProgress() {
            const container = document.getElementById('groupProgress');
            container.innerHTML = '';

            wordGroups.forEach(group => {
                const learnedInGroup = group.words.filter(w => learnedWords.includes(w.char)).length;
                const total = group.words.length;
                const percentage = (learnedInGroup / total) * 100;
                const circumference = 2 * Math.PI * 18;
                const offset = circumference - (percentage / 100) * circumference;

                const item = document.createElement('div');
                item.className = 'group-progress-item';
                item.innerHTML = `
                    <div class="group-emoji">${group.emoji}</div>
                    <div class="progress-ring">
                        <svg width="50" height="50">
                            <circle class="bg" cx="25" cy="25" r="18" fill="none" stroke-width="4"/>
                            <circle class="progress" cx="25" cy="25" r="18" fill="none" stroke-width="4"
                                stroke="${group.color}"
                                stroke-dasharray="${circumference}"
                                stroke-dashoffset="${offset}"/>
                        </svg>
                        <span class="count">${learnedInGroup}/${total}</span>
                    </div>
                `;
                container.appendChild(item);
            });
        }

        // ==================== è§†å›¾åˆ‡æ¢ ====================
        function showView(viewId) {
            document.querySelectorAll('.view').forEach(v => v.classList.remove('active'));
            document.getElementById(viewId).classList.add('active');
            currentView = viewId;
        }

        // ==================== è¯­éŸ³ç³»ç»Ÿ ====================
        function speak(text) {
            if ('speechSynthesis' in window) {
                window.speechSynthesis.cancel();
                const utterance = new SpeechSynthesisUtterance(text);
                utterance.lang = 'zh-CN';
                utterance.rate = 0.8;
                utterance.pitch = 1.1;
                window.speechSynthesis.speak(utterance);
                return utterance;
            }
            return null;
        }

        // ==================== æ˜Ÿæ˜Ÿç²’å­æ•ˆæœ ====================
        function createStarParticles(x, y) {
            const particles = ['â­', 'âœ¨', 'ğŸŒŸ', 'ğŸ’«'];
            for (let i = 0; i < 12; i++) {
                const particle = document.createElement('div');
                particle.className = 'star-particle';
                particle.textContent = particles[Math.floor(Math.random() * particles.length)];
                particle.style.left = x + 'px';
                particle.style.top = y + 'px';
                const angle = (i / 12) * Math.PI * 2;
                const distance = 80 + Math.random() * 60;
                particle.style.setProperty('--tx', Math.cos(angle) * distance + 'px');
                particle.style.setProperty('--ty', Math.sin(angle) * distance + 'px');
                document.body.appendChild(particle);
                setTimeout(() => particle.remove(), 1000);
            }
        }

        // ==================== å¥–åŠ±å¼¹çª— ====================
        function showReward(text, emoji = 'ğŸ‰') {
            document.getElementById('rewardEmoji').textContent = emoji;
            document.getElementById('rewardText').textContent = text;
            document.getElementById('rewardOverlay').classList.add('visible');
        }

        function hideReward() {
            document.getElementById('rewardOverlay').classList.remove('visible');
        }

        // ==================== è®¤å­—å¡ç‰‡æ¨¡å¼ ====================
        function initFlashcard() {
            renderGroupSelector();
            updateFlashcard();
        }

        function renderGroupSelector() {
            const container = document.getElementById('groupSelector');
            container.innerHTML = '';

            wordGroups.forEach((group, index) => {
                const btn = document.createElement('button');
                btn.className = 'group-btn' + (index === currentGroupIndex ? ' active' : '');
                btn.innerHTML = `
                    <span class="emoji">${group.emoji}</span>
                    <span>${group.name}</span>
                `;
                btn.onclick = () => {
                    currentGroupIndex = index;
                    currentCardIndex = 0;
                    document.querySelectorAll('.group-btn').forEach(b => b.classList.remove('active'));
                    btn.classList.add('active');
                    updateFlashcard();
                    // è‡ªåŠ¨å–æ¶ˆç¿»è½¬
                    document.getElementById('flashcard').classList.remove('flipped');
                };
                container.appendChild(btn);
            });
        }

        function updateFlashcard() {
            const group = wordGroups[currentGroupIndex];
            const word = group.words[currentCardIndex];

            // æ›´æ–°å¡ç‰‡æ­£é¢
            document.getElementById('cardChar').textContent = word.char;
            document.getElementById('cardPinyin').textContent = word.pinyin;
            document.getElementById('cardEmoji').textContent = word.emoji;

            // æ›´æ–°å¡ç‰‡èƒŒé¢
            document.getElementById('cardCharBack').textContent = word.char;
            document.getElementById('cardPinyinBack').textContent = word.pinyin;
            document.getElementById('cardEmojiBack').textContent = word.emoji;
            document.getElementById('cardContext').textContent = word.context;

            // æ›´æ–°å¡ç‰‡è¾¹æ¡†é¢œè‰²
            document.querySelector('.card-front').style.borderColor = group.color;

            // æ›´æ–°è¿›åº¦
            document.getElementById('cardProgress').textContent =
                `ç¬¬ ${currentCardIndex + 1} / ${group.words.length} å­—`;
        }

        function flipCard() {
            const card = document.getElementById('flashcard');
            card.classList.toggle('flipped');

            // ç¿»åˆ°èƒŒé¢æ—¶æ ‡è®°å·²å­¦ä¹ 
            if (card.classList.contains('flipped')) {
                const group = wordGroups[currentGroupIndex];
                const word = group.words[currentCardIndex];
                markLearned(word.char);
            }
        }

        function nextCard() {
            const group = wordGroups[currentGroupIndex];
            document.getElementById('flashcard').classList.remove('flipped');

            setTimeout(() => {
                currentCardIndex = (currentCardIndex + 1) % group.words.length;
                updateFlashcard();
            }, 150);
        }

        function prevCard() {
            const group = wordGroups[currentGroupIndex];
            document.getElementById('flashcard').classList.remove('flipped');

            setTimeout(() => {
                currentCardIndex = (currentCardIndex - 1 + group.words.length) % group.words.length;
                updateFlashcard();
            }, 150);
        }

        // æ»‘åŠ¨æ‰‹åŠ¿æ”¯æŒ
        let touchStartX = 0;
        function setupSwipeGesture() {
            const card = document.getElementById('flashcard');

            card.addEventListener('touchstart', (e) => {
                touchStartX = e.touches[0].clientX;
            });

            card.addEventListener('touchend', (e) => {
                const touchEndX = e.changedTouches[0].clientX;
                const diff = touchEndX - touchStartX;

                if (Math.abs(diff) > 50) {
                    if (diff > 0) {
                        prevCard();
                    } else {
                        nextCard();
                    }
                }
            });
        }

        // ==================== å¬éŸ³é€‰å­—æ¨¡å¼ ====================
        function startListenQuiz() {
            // ä»æ‰€æœ‰å­—ä¸­éšæœºé€‰10ä¸ª
            const allWords = wordGroups.flatMap(g => g.words);
            listenQuestions = shuffleArray([...allWords]).slice(0, 10);
            currentQuestionIndex = 0;
            listenScore = 0;

            updateListenUI();
            // å»¶è¿Ÿè‡ªåŠ¨æ’­æ”¾ç¬¬ä¸€é¢˜
            setTimeout(() => speakCurrentQuestion(), 500);
        }

        function updateListenUI() {
            document.getElementById('questionNum').textContent =
                `ç¬¬ ${currentQuestionIndex + 1} / 10 é¢˜`;
            document.getElementById('listenScore').textContent = listenScore;

            generateOptions();
        }

        function generateOptions() {
            const container = document.getElementById('optionsGrid');
            container.innerHTML = '';

            if (currentQuestionIndex >= listenQuestions.length) {
                // æµ‹éªŒç»“æŸ
                endListenQuiz();
                return;
            }

            const correctWord = listenQuestions[currentQuestionIndex];
            currentAnswer = correctWord.char;

            // ä»åŒç»„ä¸­é€‰æ‹©3ä¸ªå¹²æ‰°é¡¹
            const sameGroup = wordGroups.find(g =>
                g.words.some(w => w.char === correctWord.char)
            );

            let distractors = sameGroup.words
                .filter(w => w.char !== correctWord.char)
                .slice(0, 3);

            // å¦‚æœåŒç»„ä¸å¤Ÿï¼Œä»å…¶ä»–ç»„è¡¥å……
            if (distractors.length < 3) {
                const otherWords = wordGroups
                    .filter(g => g.id !== sameGroup.id)
                    .flatMap(g => g.words);
                distractors = [
                    ...distractors,
                    ...shuffleArray(otherWords).slice(0, 3 - distractors.length)
                ];
            }

            // æ··åˆæ­£ç¡®ç­”æ¡ˆå’Œå¹²æ‰°é¡¹
            const options = shuffleArray([correctWord, ...distractors]);

            options.forEach(word => {
                const btn = document.createElement('button');
                btn.className = 'option-btn';
                btn.textContent = word.char;
                btn.onclick = (e) => checkListenAnswer(word.char, e);
                container.appendChild(btn);
            });
        }

        function speakCurrentQuestion() {
            if (currentQuestionIndex < listenQuestions.length) {
                const word = listenQuestions[currentQuestionIndex];
                const btn = document.getElementById('listenSpeak');
                btn.classList.add('speaking');

                const utterance = speak(word.char);
                if (utterance) {
                    utterance.onend = () => btn.classList.remove('speaking');
                } else {
                    setTimeout(() => btn.classList.remove('speaking'), 500);
                }
            }
        }

        function checkListenAnswer(selected, event) {
            const buttons = document.querySelectorAll('.option-btn');
            const isCorrect = selected === currentAnswer;

            buttons.forEach(btn => {
                btn.style.pointerEvents = 'none';
                if (btn.textContent === currentAnswer) {
                    btn.classList.add('correct');
                }
                if (btn.textContent === selected && !isCorrect) {
                    btn.classList.add('wrong');
                }
            });

            if (isCorrect) {
                listenScore += 10;
                markLearned(selected);
                createStarParticles(event.clientX, event.clientY);
            }

            document.getElementById('listenScore').textContent = listenScore;

            // å»¶è¿Ÿè¿›å…¥ä¸‹ä¸€é¢˜
            setTimeout(() => {
                currentQuestionIndex++;
                if (currentQuestionIndex < 10) {
                    updateListenUI();
                    setTimeout(() => speakCurrentQuestion(), 300);
                } else {
                    endListenQuiz();
                }
            }, 1200);
        }

        function endListenQuiz() {
            let emoji = 'ğŸ‰';
            let text = '';

            if (listenScore >= 90) {
                emoji = 'ğŸ†';
                text = `å¤ªå‰å®³äº†ï¼æ»¡åˆ† ${listenScore} åˆ†ï¼`;
            } else if (listenScore >= 70) {
                emoji = 'â­';
                text = `å¾ˆæ£’ï¼å¾—äº† ${listenScore} åˆ†ï¼`;
            } else if (listenScore >= 50) {
                emoji = 'ğŸ‘';
                text = `ä¸é”™å“¦ï¼å¾—äº† ${listenScore} åˆ†ï¼`;
            } else {
                emoji = 'ğŸ’ª';
                text = `ç»§ç»­åŠ æ²¹ï¼å¾—äº† ${listenScore} åˆ†`;
            }

            showReward(text, emoji);
        }

        // ==================== é…å¯¹æ¶ˆé™¤æ¨¡å¼ ====================
        function startMatchGame(pairs) {
            // éšæœºé€‰æ‹©é…å¯¹çš„å­—
            const allWords = wordGroups.flatMap(g => g.words);
            const selectedWords = shuffleArray([...allWords]).slice(0, pairs);

            // åˆ›å»ºé…å¯¹å¡ç‰‡ï¼ˆæ±‰å­—å¡ + emojiå¡ï¼‰
            matchCards = [];
            selectedWords.forEach((word, index) => {
                matchCards.push({
                    id: index,
                    type: 'char',
                    char: word.char,
                    pinyin: word.pinyin,
                    pairId: index
                });
                matchCards.push({
                    id: index + pairs,
                    type: 'emoji',
                    emoji: word.emoji,
                    pinyin: word.pinyin,
                    pairId: index
                });
            });

            matchCards = shuffleArray(matchCards);

            flippedCards = [];
            matchedPairs = 0;
            totalMatchPairs = pairs;
            flipCount = 0;
            isChecking = false;

            renderMatchGrid(pairs);
            updateMatchStats();

            document.getElementById('difficultySelect').style.display = 'none';
            document.getElementById('matchGrid').style.display = 'grid';
            document.getElementById('matchStats').style.display = 'flex';
            document.getElementById('matchComplete').classList.remove('visible');
        }

        function renderMatchGrid(pairs) {
            const container = document.getElementById('matchGrid');
            container.innerHTML = '';

            // æ ¹æ®é…å¯¹æ•°é‡è®¾ç½®åˆ—æ•°
            let cols = 3;
            if (pairs === 3) cols = 3;
            else if (pairs === 6) cols = 4;
            else if (pairs === 9) cols = 6;

            container.style.gridTemplateColumns = `repeat(${cols}, 1fr)`;

            matchCards.forEach((card, index) => {
                const cardEl = document.createElement('div');
                cardEl.className = 'match-card';
                cardEl.dataset.index = index;

                let backContent = '';
                if (card.type === 'char') {
                    backContent = `<span class="char">${card.char}</span>`;
                } else {
                    backContent = `
                        <span class="emoji">${card.emoji}</span>
                        <span class="pinyin">${card.pinyin}</span>
                    `;
                }

                cardEl.innerHTML = `
                    <div class="match-card-inner">
                        <div class="match-card-front">â­</div>
                        <div class="match-card-back">${backContent}</div>
                    </div>
                `;

                cardEl.onclick = () => flipMatchCard(index);
                container.appendChild(cardEl);
            });
        }

        function flipMatchCard(index) {
            if (isChecking) return;
            if (flippedCards.includes(index)) return;
            if (flippedCards.length >= 2) return;

            const cardEl = document.querySelectorAll('.match-card')[index];
            if (cardEl.classList.contains('matched')) return;

            cardEl.classList.add('flipped');
            flippedCards.push(index);
            flipCount++;
            updateMatchStats();

            if (flippedCards.length === 2) {
                isChecking = true;
                setTimeout(checkMatch, 800);
            }
        }

        function checkMatch() {
            const [idx1, idx2] = flippedCards;
            const card1 = matchCards[idx1];
            const card2 = matchCards[idx2];

            const cardEls = document.querySelectorAll('.match-card');

            if (card1.pairId === card2.pairId && card1.type !== card2.type) {
                // é…å¯¹æˆåŠŸ
                cardEls[idx1].classList.add('matched');
                cardEls[idx2].classList.add('matched');
                matchedPairs++;

                // æ ‡è®°å·²å­¦ä¹ 
                const word = matchCards.find(c => c.type === 'char' && c.pairId === card1.pairId);
                if (word) markLearned(word.char);

                // åˆ›å»ºç²’å­æ•ˆæœ
                const rect1 = cardEls[idx1].getBoundingClientRect();
                createStarParticles(rect1.left + rect1.width/2, rect1.top + rect1.height/2);

                updateMatchStats();

                if (matchedPairs === totalMatchPairs) {
                    setTimeout(endMatchGame, 500);
                }
            } else {
                // é…å¯¹å¤±è´¥ï¼Œç¿»å›å»
                setTimeout(() => {
                    cardEls[idx1].classList.remove('flipped');
                    cardEls[idx2].classList.remove('flipped');
                }, 300);
            }

            flippedCards = [];
            isChecking = false;
        }

        function updateMatchStats() {
            document.getElementById('flipCount').textContent = flipCount;
            document.getElementById('matchedCount').textContent = matchedPairs;
            document.getElementById('totalPairs').textContent = totalMatchPairs;
        }

        function endMatchGame() {
            document.getElementById('matchGrid').style.display = 'none';
            document.getElementById('matchStats').style.display = 'none';

            const efficiency = Math.round((totalMatchPairs * 2 / flipCount) * 100);
            document.getElementById('matchResultStats').textContent =
                `ç¿»ç‰Œ ${flipCount} æ¬¡å®Œæˆ ${totalMatchPairs} å¯¹é…å¯¹ï¼Œæ•ˆç‡ ${efficiency}%`;

            document.getElementById('matchComplete').classList.add('visible');
        }

        function resetMatchGame() {
            document.getElementById('matchGrid').style.display = 'none';
            document.getElementById('matchStats').style.display = 'none';
            document.getElementById('matchComplete').classList.remove('visible');
            document.getElementById('difficultySelect').style.display = 'flex';
        }

        // ==================== æ˜Ÿçƒå›¾é‰´æ¨¡å¼ ====================
        function initExplore() {
            renderPlanetTabs();
            showPlanetWords(0);
        }

        function renderPlanetTabs() {
            const container = document.getElementById('planetTabs');
            container.innerHTML = '';

            wordGroups.forEach((group, index) => {
                const tab = document.createElement('button');
                tab.className = 'planet-tab' + (index === 0 ? ' active' : '');
                tab.innerHTML = `
                    <span class="emoji">${group.emoji}</span>
                    <span>${group.name}</span>
                `;
                tab.onclick = () => {
                    document.querySelectorAll('.planet-tab').forEach(t => t.classList.remove('active'));
                    tab.classList.add('active');
                    showPlanetWords(index);
                };
                container.appendChild(tab);
            });
        }

        function showPlanetWords(groupIndex) {
            const container = document.getElementById('wordCollection');
            container.innerHTML = '';

            const group = wordGroups[groupIndex];

            group.words.forEach(word => {
                const card = document.createElement('div');
                card.className = 'word-card' + (learnedWords.includes(word.char) ? ' learned' : '');
                card.innerHTML = `
                    <span class="char">${word.char}</span>
                    <span class="pinyin">${word.pinyin}</span>
                    <span class="emoji">${word.emoji}</span>
                `;
                card.onclick = () => {
                    speak(word.char);
                    markLearned(word.char);
                    card.classList.add('learned');
                };
                container.appendChild(card);
            });
        }

        // ==================== å·¥å…·å‡½æ•° ====================
        function shuffleArray(array) {
            const arr = [...array];
            for (let i = arr.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [arr[i], arr[j]] = [arr[j], arr[i]];
            }
            return arr;
        }

        // ==================== æ˜Ÿç©ºèƒŒæ™¯ ====================
        function createStars() {
            const starsEl = document.getElementById('stars');
            for (let i = 0; i < 100; i++) {
                const s = document.createElement('div');
                s.className = 'star';
                const size = Math.random() * 2.5 + 0.5;
                s.style.cssText = `
                    width: ${size}px; height: ${size}px;
                    left: ${Math.random() * 100}%;
                    top: ${Math.random() * 100}%;
                    animation-delay: ${Math.random() * 3}s;
                    animation-duration: ${2 + Math.random() * 3}s;
                `;
                starsEl.appendChild(s);
            }
        }

        // ==================== åˆå§‹åŒ– ====================
        function init() {
            createStars();
            getProgress();
            updateProgressUI();

            // ä¸»èœå•æŒ‰é’®
            document.querySelectorAll('.menu-btn').forEach(btn => {
                btn.onclick = () => {
                    const mode = btn.dataset.mode;
                    if (mode === 'flashcard') {
                        showView('flashcardView');
                        initFlashcard();
                    } else if (mode === 'listen') {
                        showView('listenView');
                        startListenQuiz();
                    } else if (mode === 'match') {
                        showView('matchView');
                        resetMatchGame();
                    } else if (mode === 'explore') {
                        showView('exploreView');
                        initExplore();
                    }
                };
            });

            // è®¤å­—å¡ç‰‡æ§åˆ¶
            document.getElementById('flashcard').onclick = flipCard;
            document.getElementById('prevCard').onclick = prevCard;
            document.getElementById('nextCard').onclick = nextCard;
            document.getElementById('speakBtn').onclick = () => {
                const group = wordGroups[currentGroupIndex];
                const word = group.words[currentCardIndex];
                const btn = document.getElementById('speakBtn');
                btn.classList.add('speaking');
                const utterance = speak(word.char);
                if (utterance) {
                    utterance.onend = () => btn.classList.remove('speaking');
                } else {
                    setTimeout(() => btn.classList.remove('speaking'), 500);
                }
            };
            setupSwipeGesture();

            // å¬éŸ³é€‰å­—æ§åˆ¶
            document.getElementById('listenSpeak').onclick = speakCurrentQuestion;

            // é…å¯¹æ¶ˆé™¤æ§åˆ¶
            document.querySelectorAll('#difficultySelect button').forEach(btn => {
                btn.onclick = () => startMatchGame(parseInt(btn.dataset.pairs));
            });
            document.getElementById('playAgainBtn').onclick = resetMatchGame;

            // è¿”å›æŒ‰é’®
            document.getElementById('flashcardBack').onclick = () => showView('mainMenu');
            document.getElementById('listenBack').onclick = () => showView('mainMenu');
            document.getElementById('matchBack').onclick = () => showView('mainMenu');
            document.getElementById('exploreBack').onclick = () => showView('mainMenu');

            // å¥–åŠ±å¼¹çª—
            document.getElementById('rewardBtn').onclick = () => {
                hideReward();
                showView('mainMenu');
            };
        }

        // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>

</html>
